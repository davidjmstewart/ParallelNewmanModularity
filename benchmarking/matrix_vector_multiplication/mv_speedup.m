clear all;
close all;

fig = figure;
matrix_sizes = [100, 200, 400, 800, 1600, 3200, 6400, 12800];
% matrix_sizes = [1000000, 2000000, 3000000, 4000000];

parallel_timings = [
0.000008720  0.000732040  0.001897940  0.000830640  0.002137880  0.000673890  0.002341960  0.002711920  0.000859970  0.000779600  0.001182250  0.001078420  0.000778160  0.001953310  0.000730480  0.000783320 
0.000028740  0.000246380  0.001789350  0.000805500  0.001286410  0.001098670  0.003097150  0.003790050  0.001130230  0.000653310  0.001751560  0.000794690  0.000751370  0.000807560  0.002139210  0.000962890 
0.000132370  0.000341830  0.002308590  0.001271530  0.001884090  0.001095390  0.003462860  0.003713610  0.001804230  0.000754360  0.000899740  0.000919780  0.000973990  0.001460640  0.001006840  0.000928600 
0.000468420  0.000713240  0.001318520  0.000844060  0.001245640  0.001298330  0.003190820  0.003611750  0.001228030  0.000866990  0.000834780  0.001411570  0.000890570  0.000950250  0.000888570  0.001218860 
0.002194260  0.002062620  0.001843350  0.002046340  0.001965780  0.003082630  0.004245690  0.004557530  0.001899040  0.002067770  0.001987920  0.001809980  0.001666500  0.001695810  0.001727090  0.001841100 
0.007824370  0.005382580  0.005143070  0.004515280  0.004347200  0.005124460  0.004899220  0.006379570  0.004522720  0.004237620  0.004226530  0.005003480  0.004092860  0.003940630  0.004280370  0.004288170 
0.030734280  0.020759730  0.015935560  0.014722790  0.014615190  0.014454610  0.015205550  0.015031240  0.014919600  0.015202580  0.015773180  0.014378930  0.013741750  0.013695350  0.013899550  0.014167120 
0.123981660  0.078484850  0.061917440  0.055407240  0.054795090  0.055427450  0.051177070  0.049314720  0.052953290  0.051166000  0.052587160  0.054588840  0.050231090  0.049335230  0.050157270  0.052323720]

T = [1: 16];

sequential_averages = [
0.000010850 
0.000052830 
0.000227670 
0.000791960 
0.003590490 
0.012939130 
0.052519320 
0.211899280 
]
for i = 1:size(parallel_timings, 1)
    subplot(4,2,i); 
    hold on;
    grid on;
%     xlim([1 16]);
%     ylim([0 6]);
    plot(T, parallel_timings(i,:).^-1 * sequential_averages(i), 'LineWidth', 2);
    title(sprintf('%d element Vector',matrix_sizes(i)));
end

handle=axes(fig,'visible','off'); 
handle.XLabel.Visible='on';
handle.YLabel.Visible='on';
handle.Title.Visible='on';
ylabel(handle,'Speedup');
xlabel(handle,'Number of threads');
title(handle,'Speedup of parallelising Matrix-Vector multiplication with SIMD support');
handle.Title.Position(2) = 1.05
grid on;

tic
VEC_SIZE = 500000000;
dot(rand(1,VEC_SIZE), rand(1,VEC_SIZE));
    toc